<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gio hang</title>
    <link rel="icon" href="/images/Page1/LoadWeb.png" type="image/png">
    <link rel="stylesheet" href="/styles/style.css">
    <script src="/js/index.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz"
        crossorigin="anonymous"></script>

    <!-- bootstarp stackpath cdn -->
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css"
        integrity="sha384-MCw98/SFnGE8fJT3GXwEOngsV7Zt27NXFoaoApmYm81iuXoPkFOJwJ8ERdknLPMO" crossorigin="anonymous">

    <!-- Bootstrap icons cdn-->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.min.css">
    <style>
        .ShopMore {
            background-color: black;
            font-size: 18px;
            font-weight: 700;
            outline: none;
            border-radius: 2px;
            border: none;
            color: aliceblue;
            padding: 13px 30px;
            cursor: pointer;
            text-transform: uppercase;
            transition: 0.5s ease-in-out;
            padding: 20px;
            width: 250px;
        }

        .ShopMore:hover {
            background-color: #BC1F23;
            color: black;
        }

        .form-group {
            display: flex;
            align-items: center;
            /* Căn giữa theo chiều dọc */
            margin-bottom: 1rem;
        }

        .form-group label {
            flex: 0 0 30%;
            /* Độ rộng của label chiếm 30% */
            margin-bottom: 0;
            /* Loại bỏ khoảng cách mặc định */
            color: #343a40;
            font-weight: bold;
        }

        .form-group select {
            flex: 1;
            /* Chiếm phần còn lại của hàng */
            padding: 0.375rem 0.75rem;
            font-size: 1rem;
            line-height: 1.5;
            border: 1px solid #ced4da;
            border-radius: 0.25rem;
            background-color: #fff;
        }
    </style>
</head>

<body>
    <nav class="navbar navbar-expand-lg navbar-light bg-dark py-4 fixed-top">
        <div class="container-fluid mr-5">
            <!-- <div class="col-1"></div> -->
            <img src="/images/Page1/LogoWeb.png" onclick="location.reload();"
                id="logo-img" alt="logo..">

            <button class="navbar-toggler" onclick="toggleMenu()">
                <span><i id="nav-bar-icon" class="bi bi-list"></i></span>
            </button>
            <!-- <div class="search-bar">
                <input type="text" class="search-input" id="searchInput" placeholder="Tìm kiếm...">
                <button class="search-button" id="searchButton">
                    <i class="bi bi-search"></i>
                </button>
            </div>

            <div id="searchResults" class="search-results"></div> -->


            <div class="collapse navbar-collapse" id="navbarSupportedContent">
                <ul class="navbar-nav ml-auto">

                    <li class="nav-item">
                        <a class="nav-link" href="/html/index.html">Trang Chủ</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/html/Menu/shop.html">Cửa Hàng</a>
                    </li>
                    <!-- <li class="nav-item">
                        <a class="nav-link" href="#">Quality</a>
                    </li> -->
                    <li class="nav-item">
                        <a class="nav-link" href="/html/Menu/AboutUs.html">Thông
                            tin</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="/html/Menu/ContactUs.html">Liên
                            hệ</a>

                    </li>
                    <li class="nav-item" id="nav-icons">
                        <!-- <i class="bi bi-search"></i> -->
                        <a href="/html/Menu/Login.html"><i
                                class="bi bi-person-fill"></i></a>
                        <a href="/html/Menu/Cart.html"><i
                                class="bi bi-bag-heart-fill"></i></a>
                    </li>

                </ul>
            </div>


            <!-- Biểu tượng menu để mở/đóng sidebar
                <i class="bi bi-list menu-icon" onclick="toggleMenu()" id="menu-btn"></i>

                <-- Sidebar menu -->
            <div id="mySideBar" class="sidebar">
                <div class="sidebar-header">
                    <img src="/images/Page1/LogoWeb.png" alt="Logo" class="logo">
                    <span id="closeBtn" class="close-btn" onclick="toggleMenu()">&times;</span>
                </div>
                <div class="sidebar-content">
                    <div class="menu-section">
                        <h4><a href="/html/index.html">TRANG CHỦ</a></h4>
                    </div>
                    <div class="menu-section">
                        <h4><a href="/html/Menu/Cart.html">GIỎ HÀNG</a></h4>
                    </div>
                    <div class="menu-section">
                        <h4><a href="/html/Menu/AboutUs.html">VỀ MFS</a></h4>

                    </div>
                    <div class="menu-section">
                        <h4><a href="/html/sidebar/chinhsach.html">CHÍNH SÁCH</a></h4>

                    </div>
                    <div class="menu-section">
                        <h4><a href="javascript:void(0);" class="toggle-menu">THỰC ĐƠN</a></h4>
                        <ul class="submenu">
                            <li><a href="/html/Menu/shop.html">Các món đùi gà nổi
                                    bật</a></li>
                            <li><a href="/html/Menu/shop1.html">Các món cánh gà nổi
                                    bật</a></li>
                            <li><a href="#">Combo gà phải thử</a></li>
                        </ul>
                    </div>
                    <div class="menu-section">
                        <h4><a href="#">DỊCH VỤ</a></h4>
                    </div>
                    <div class="menu-section">
                        <h4><a href="/html/Menu/ContactUs.html">LIÊN HỆ</a></h4>
                    </div>
                    <div class="menu-section">
                        <h4><a href="#">TUYỂN DỤNG</a></h4>
                    </div>

                    <div class="menu-section user" id="user-sidebar">
                        <h4><i class="bi bi-person"></i><a
                                href="/html/Menu/Login.html">ĐĂNG NHẬP</a> / <a
                                href="/html/Menu/Register.html">ĐĂNG KÝ</a></h4>

                    </div>
                    <div class="menu-section user-logged-in" id="user-logged-in" style="display: none;">
                        <span id="greeting-menu"></span>
                        <h4><a href="/html/Menu/Profile.html">TÀI KHOẢN CỦA TÔI / </a>
                        </h4>
                        <h4><i class="bi bi-person"></i><a href="javascript:void(0);" onclick="logout()">ĐĂNG XUẤT</a>
                        </h4>
                    </div>
                </div>
            </div>
    </nav>

    <!-- cart section -->
    <section id="featured" class="mt-3 pt-1">
        <div class="container mx-auto mt-5 px-5 pt-5 text-center">
            <h3 class="mt-5 pt-5">Giỏ Hàng Của Bạn</h3>
            <hr class="border border-danger border-2 opacity-75 mx-auto">
        </div>
    </section>

    <section id="cart-container" class="container-fluid my-5">
        <table width="100%" id="cart-table">
            <thead>
                <tr>
                    <td>Xóa</td>
                    <td>Hình ảnh</td>
                    <td>Sản phẩm</td>
                    <td>Giá</td>
                    <td>Số lượng </td>
                    <td>Tổng tiền</td>
                </tr>
            </thead>

            <tbody>

            </tbody>
        </table>
    </section>

    <section id="cart-bottom" class="container">
        <div class="row">
            <!-- <div class="coupon col-lg-6 col-md-6 col-12 mb-4">
                <div>
                    <h5>COUPON</h5>
                    <p>Enter the coupon code if you have one.</p>
                    <input type="text" placeholder="Coupon code">
                    <button>APPLY COUPON</button>
                </div>        
            </div> -->
            <div class="Total col-lg-8 col-md-6 col-12 mb-4 mx-auto">
                <div>
                    <h5>Tổng giỏ hàng</h5>
                    <div class="d-flex justify-content-between">
                        <h6>Tạm tính</h6>
                        <p id="subtotal-value"></p>
                    </div>
                    <div class="d-flex justify-content-between">
                        <h6>Phí vận chuyển</h6>
                        <p id="shipping-value"></p>
                    </div>
                    <div class="d-flex justify-content-between">
                        <h6>Thời gian giao hàng dự kiến </h6>
                        <p id="shippingtime">1h</p>
                    </div>
                    <hr class="second-hr">
                    <div id="discount-row" class="d-flex justify-content-between" style="display: none;">
                        <h6>Giảm giá</h6>
                        <p id="discount-value"></p>
                    </div>
                    <div class="d-flex justify-content-between">
                        <h6>Tổng cộng</h6>
                        <p id="total-value"></p>
                    </div>
                    <div class="form-group my-3">
                        <label for="voucherSelect">
                            <h6>Chọn voucher</h6>
                        </label>
                        <select class="form-control" id="voucherSelect" onchange="applyVoucher()">
                            <option value="0">Không sử dụng voucher</option>
                            <option value="5000">Giảm 5,000 VND</option>
                            <option value="10000">Giảm 10,000 VND</option>
                        </select>
                    </div>

                    <!-- Phương thức thanh toán -->
                    <div class="form-group my-3">
                        <label for="paymentMethod">
                            <h6>Phương thức thanh toán</h6>
                        </label>
                        <select class="form-control" id="paymentMethod">
                            <option value="cash">Thanh toán tiền mặt</option>
                            <option value="card">Thanh toán bằng thẻ</option>
                            <option value="card">Thanh toán bằng momo</option>
                        </select>
                    </div>
                    <button class="ml-auto" onclick="handlePayment()">TIẾN HÀNH THANH
                        TOÁN</button>
                </div>
            </div>
        </div>
    </section>


    <!-- Related Product section -->
    <section id="featured" class="my-5 pb-5">
        <div class="container text-center mt-5 py-5">
            <h3>Các sản phẩm liên quan</h3>
            <hr class="border border-danger border-2 opacity-75 mx-auto">
        </div>
        <div class="row mx-auto container-fluid">
            <div class="product text-center col-lg-3 col-md-4 col-12">
                <img class="img-fluid" src="/images/CanhGa/CanhGaXiMuoi.png"
                    alt="Cánh gà xí muội">

                <h5 class="product-name">Cánh gà sốt cay xí muội</h5>
                <h4 class="product-price">30.000 VND</h4>
                <button class="buy-btn" onclick="window.location.href = 'sproduct13.html';">Mua ngay</button>
            </div>
            <div class="product text-center col-lg-3 col-md-4 col-12">
                <img class="img-fluid" src="/images/CanhGa/CanhGaKieuThai.jpg"
                    alt="Gà rán sốt cay kiểu Thái">

                <h5 class="product-name">Gà rán sốt cay kiểu Thái</h5>
                <h4 class="product-price">45.000 VND</h4>
                <button class="buy-btn" onclick="window.location.href = 'sproduct17.html';">Mua ngay</button>
            </div>
            <div class="product text-center col-lg-3 col-md-4 col-12">
                <img class="img-fluid" src="/images/CanhGa/CanhGaChanhDay.jpg"
                    alt="Gà rán giòn sốt chanh dây">

                <h5 class="product-name">Gà rán giòn sốt chanh dây</h5>
                <h4 class="product-price">50.000 VND</h4>
                <button class="buy-btn" onclick="window.location.href = 'sproduct20.html';">Mua ngay</button>
            </div>
            <div class="product container text-center col-lg-3 col-md-4 col-12">
                <img class="img-fluid" src="/images/CanhGa/CanhGaKieuNhat.jpg"
                    alt="Gà rán xù kiểu Nhật">

                <h5 class="product-name">Gà rán xù kiểu Nhật</h5>
                <h4 class="product-price">39.000 VND</h4>
                <button class="buy-btn" onclick="window.location.href = 'sproduct21.html';">Mua ngay</button>
            </div>
            <button class="ShopMore my-5 mx-auto" onclick="window.location.href = 'Shop.html';">Tiếp tục mua
                sắm</button>
        </div>
    </section>

    <footer class="mt-5 p-5 bg-dark">
        <div class="row conatiner mx-auto pt-5">
            <div class="footer-one col-lg-3 col-md-6 col-12">

                <img id="logo-img-footer" src="/images/Page1/LogoWeb.png" alt="logo">
                <p class="py-3 pl-2 ml-4 mr-5">Tiệm Gà Sao Hỏa là một quán ăn hiện đại với phong cách thiết kế đậm chất
                    không gian. Thực đơn của quán không chỉ có các món gà nổi tiếng, mà còn kèm theo những món ăn độc lạ
                    lấy cảm hứng từ vũ trụ mang lại cảm giác mới mẻ cho thực khách.</p>

            </div>

            <div class="footer-one col-lg-3 col-md-6 col-12 mb-3">
                <h5 class="pb-2">Liên kết nhanh</h5>
                <ul class="text-uppercase list-unstyled">
                    <li><a href="index.html">trang chủ</a></li>
                    <li><a href="/html/Menu/shop.html">Cửa hàng</a></li>
                    <li><a href="/html/Menu/AboutUs.html">thông tin</a></li>
                    <li><a href="/html/Menu/ContactUs.html">liên hệ</a></li>
                    <li><a href="/html/Menu/Cart.html">Giỏ hàng</a></li>
                </ul>
            </div>
            <div class="footer-one col-lg-3 col-md-6 col-12 mb-3">
                <h5 class="pb-2">Liên hệ với chúng tôi</h5>
                <div>
                    <h6 class="text-uppercase">Địa chỉ</h6>
                    <p>Khu phố 6, Phường Linh Trung, TP. Thủ Đức, TP. Hồ Chí Minh</p>
                </div>
                <div>
                    <h6 class="text-uppercase">điện thoại</h6>
                    <p>0849294483</p>
                </div>
                <div>
                    <h6 class="text-uppercase">Email</h6>
                    <p>MarsStore@gmail.com</p>
                </div>
            </div>
            <div class="Photos col-lg-3 col-md-6 col-12">
                <h5 class="pb-2">Các đơn vị tài trợ</h5>
                <div class="row">
                    <img class="footer-img img-fluid mb-2"
                        src="/images/Page1/image copy 3.png" alt="leather-img">
                    <img class="footer-img img-fluid mb-2"
                        src="/images/Page1/image copy 2.png" alt="leather-img">
                    <img class="footer-img img-fluid mb-2"
                        src="/images/Page1/image copy.png" alt="leather-img">
                    <img class="footer-img img-fluid mb-2"
                        src="/images/Page1/image.png" alt="leather-img">
                </div>
            </div>
            <div class="copyright mt-5">
                <div class="row container mx-auto">
                    <!-- <div class="col-lg-3 col-md-6 col-12 mb-4">
        <img src="img/payment.png" alt="payment..logo">
      </div> -->

                    <div class="col-lg-6 col-md-8 col-12 mb-2 mx-auto">
                        <p>MARSSTORE WEBSITE &copy; DESIGN 2024</p>
                    </div>

                    <div class="col-lg-3 col-md-6 col-12">
                        <a href="https://www.facebook.com/"><i class="bi bi-facebook"></i></a>
                        <a href="https://x.com/home?lang=vi"><i class="fa-brands fa-x-twitter"></i></a>
                        <a href="https://www.linkedin.com/feed/"><i class="bi bi-linkedin"></i></a>
                        <a href="https://www.instagram.com/"><i class="bi bi-instagram"></i></a>
                    </div>
                </div>
            </div>
    </footer>
    <script>

        //     const cartData = window.localStorage.getItem('cart');
        //     const cart = JSON.parse(cartData); // {"id": "quantity", "id": "quantity"}

        //     console.log(productList) // {"id": {"name": "", "price": "", "image": ""}}

        //     // if cart is empty, then show a message "No items in cart"
        //     if (!cart || Object.keys(cart).length === 0) {
        //         document.querySelector('#cart-table tbody').innerHTML = '<tr><td colspan="6">Không có sản phẩm nào trong giỏ hàng</td></tr>';
        //         document.querySelector('#subtotal-value').textContent = "0";
        //         document.querySelector('#shipping-value').textContent = "0";
        //         document.querySelector('#total-value').textContent = "0";
        //     }
        //     else {
        //         Object.keys(cart).forEach((id) => {
        //             const product = productList[id];
        //             const quantity = cart[id];
        //             const total = product.price * quantity;
        //             const tr = document.createElement('tr');
        //            tr.innerHTML = `
        //                 <td><button id="trash-btn" onclick="removeFromCart(${id})"><i class="bi bi-trash3"></i></button></td>
        //                 <td><img src="${product.image}" alt="product"></td>
        //                 <td><h5>${product.name}</h5></td>
        //                 <td><h5>${Number(product.price).toLocaleString('vi-VN')} VND</h5></td>
        //                 <td><input class="w-25 pl-1" type="number" value="${quantity}" disabled min="1" max="10"></td>
        //                 <td><h5>${total.toLocaleString('vi-VN')} VND</h5></td>
        //             `;


        //             document.querySelector('#cart-table tbody').appendChild(tr);
        //         });

        //         const subtotal = Object.keys(cart).reduce((acc, id) => {
        //             const product = productList[id];
        //             const quantity = cart[id];
        //             return acc + product.price * quantity;
        //         }, 0);

        //         const shipping = 12000;

        //         document.querySelector('#subtotal-value').textContent = subtotal.toLocaleString('vi-VN') + " VND";
        //         document.querySelector('#shipping-value').textContent = shipping.toLocaleString('vi-VN') + " VND";
        //         document.querySelector('#total-value').textContent = (subtotal + shipping).toLocaleString('vi-VN') + " VND";

        //     }
        const cartData = window.localStorage.getItem('cart');
        const cart = JSON.parse(cartData); // {"id": "quantity", "id": "quantity"}

        if (!cart || Object.keys(cart).length === 0) {
            document.querySelector('#cart-table tbody').innerHTML = '<tr><td colspan="6">Không có sản phẩm nào trong giỏ hàng</td></tr>';
            document.querySelector('#subtotal-value').textContent = "0 VND";
            document.querySelector('#shipping-value').textContent = "0 VND";
            document.querySelector('#total-value').textContent = "0 VND";
            document.querySelector('#discount-value').textContent = "0 VND";
        } else {
            Object.keys(cart).forEach((id) => {
                const product = productList[id];
                const quantity = cart[id];
                const total = product.price * quantity;
                const tr = document.createElement('tr');
                tr.innerHTML = `
            <td><button id="trash-btn" onclick="removeFromCart(${id})"><i class="bi bi-trash3"></i></button></td>
            <td><img src="${product.image}" alt="product"></td>
            <td><h5>${product.name}</h5></td>
            <td><h5>${Number(product.price).toLocaleString('vi-VN')} VND</h5></td>
            <td><input class="w-25 pl-1" type="number" value="${quantity}" disabled min="1" max="10"></td>
            <td><h5>${total.toLocaleString('vi-VN')} VND</h5></td>
        `;

                document.querySelector('#cart-table tbody').appendChild(tr);
            });

            const subtotal = Object.keys(cart).reduce((acc, id) => {
                const product = productList[id];
                const quantity = cart[id];
                return acc + product.price * quantity;
            }, 0);

            const shipping = 12000;
            let discount = 0;

            // Tính tổng cộng trước khi áp dụng giảm giá
            const totalBeforeDiscount = subtotal + shipping;

    // Áp dụng giảm giá nếu tổng cộng > 320,000 VND
    if (totalBeforeDiscount > 320000) {
        discount = subtotal * 0.2; // Giảm giá 20%
    }

    // Hiển thị các giá trị
    document.querySelector('#subtotal-value').textContent = subtotal.toLocaleString('vi-VN') + " VND";
    document.querySelector('#shipping-value').textContent = shipping.toLocaleString('vi-VN') + " VND";

            // Tính và hiển thị tổng cộng sau giảm giá
            const total = totalBeforeDiscount - discount;
            document.querySelector('#total-value').textContent = total.toLocaleString('vi-VN') + " VND";

            // Chỉ hiển thị giảm giá khi có giảm giá
            const discountElement = document.getElementById('discount-value');
            const discountRow = document.getElementById('discount-row');
            if (discount > 0) {
                discountElement.textContent = `- ${discount.toLocaleString('vi-VN')} VND`;
                discountRow.style.display = "flex"; // Hiển thị dòng giảm giá
            } else {
                discountRow.style.display = "none"; // Ẩn nếu không có giảm giá
            }
        }

        // Hàm cập nhật giá trị tổng tiền sau khi áp dụng voucher
        function applyVoucher() {
            const voucherSelect = document.getElementById("voucherSelect");
            const discountRow = document.getElementById("discount-row");
            const discountValue = document.getElementById("discount-value");
            const totalValue = document.getElementById("total-value");

            // Giá trị tạm tính và phí vận chuyển (các giá trị này là mẫu)
            let subtotal = 100000; // Giá trị tạm tính ban đầu (mẫu)
            let shippingFee = 15000; // Phí vận chuyển (mẫu)

            // Lấy giá trị giảm giá từ voucher
            const discount = parseInt(voucherSelect.value);

            // Tính toán tổng tiền sau giảm giá
            let total = subtotal + shippingFee - discount;

            // Cập nhật UI
            if (discount > 0) {
                discountRow.style.display = "flex";
                discountValue.textContent = `-${discount.toLocaleString()} VND`;
            } else {
                discountRow.style.display = "none";
            }

            totalValue.textContent = `${total.toLocaleString()} VND`;
        }

        // Hàm xử lý thanh toán khi nhấn nút "TIẾN HÀNH THANH TOÁN"
        function handlePayment() {
            const paymentMethod = document.getElementById("paymentMethod").value;
            const totalValue = document.getElementById("total-value").textContent;

            // Kiểm tra phương thức thanh toán
            if (paymentMethod === "cash") {
                alert(`Thanh toán thành công! Số tiền cần thanh toán: ${totalValue}`);
                window.location.href = "/html/index.html";
                localStorage.removeItem("cart");

            } else if (paymentMethod === "card") {
                window.location.href = "checkout.html"; // Chuyển hướng đến trang checkout
            } else if (paymentMethod === "momo") {
                window.location.href = "./momo.html"; // Chuyển hướng đến trang Momo
            } else {
                alert("Vui lòng chọn phương thức thanh toán!");
            }
        }

        // Gọi hàm applyVoucher() ngay khi tải trang để đảm bảo các giá trị được cập nhật ban đầu
        document.addEventListener("DOMContentLoaded", applyVoucher);



    </script>


    <!-- bootstarp cdn -->
    <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js"
        integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r"
        crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js"
        integrity="sha384-0pUGZvbkm6XF6gxjEnlmuGrJXVbNuzT9qBBavbLwCsOGabYfZo0T0to5eqruptLy"
        crossorigin="anonymous"></script>
</body>

</html>